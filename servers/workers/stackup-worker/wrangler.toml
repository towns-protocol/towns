main = "./src/index.ts"
name = "stackup-worker"
compatibility_date = "2024-05-24"
logpush = true
node_compat = true
account_id = "9840f8a36a817b103e00e29a0e2bad6f"

kv_namespaces = [
  { binding = "OVERRIDES", id = "<ignored>", preview_id = "<ignored>" },
  { binding = "CREATE_TOWN", id = "<ignored>", preview_id = "<ignored>" },
  { binding = "EMAIL_WHITELIST", id = "<ignored>", preview_id = "<ignored>" },
  { binding = "TOWN_WHITELIST", id = "<ignored>", preview_id = "<ignored>" },
]

[dev]
ip = "localhost"
port = 8686
local_protocol = "http"

[vars]
# VAR_NAME = "some_value"
ENVIRONMENT = "development"
SKIP_TOWNID_VERIFICATION = "false"


# The necessary secrets are:
# PRIVY_APP_KEY
# PRIVY_APP_ID
# ALCHEMY_API_KEY
# ALCHEMY_GM_POLICY_ID_OPEN
# ALCHEMY_PAYMASTER_RPC_URL
# ALCHEMY_GM_POLICY_ID
# STACKUP_PAYMSTER_RPC_URL
# AUTH_SECRET (for paymaster proxy api)
# ADMIN_AUTH_SECRET (for admin api)
#
#
# for local development, you can add these in .dev.vars
# OR
# Run `echo <VALUE> | wrangler secret put <NAME>` for each of these
# add your secret property names here
#
# AUTH_SECRET

[env.test-beta]
routes = [
  { pattern = "stackup-worker-test-beta.towns.com", custom_domain = true },
]
vars = { ENVIRONMENT = "test-beta", SKIP_TOWNID_VERIFICATION = "false" }
# created with
# wrangler kv:namespace create "CREATE_TOWN"
kv_namespaces = [
  { binding = "CREATE_TOWN", id = "79073d416a8049e1ab07451baa7be8e4" },
  { binding = "OVERRIDES", id = "f7b8710535cc41aeb528d09252280de4" },
  { binding = "JOIN_TOWN", id = "87410d76977e4520ac4b321dcd8bf27b" },
  { binding = "LINK_WALLET_TO_ROOT_KEY", id = "4b110cc687c644e0ba1a0e101c7d023f" },
  { binding = "EMAIL_WHITELIST", id = "eb8c66a24b854f48be3c8f133e7d6380" },
  { binding = "TOWN_WHITELIST", id = "1a8c855fa6b548ffa63316fa3b249f8a" },
]

[env.omega]
routes = [{ pattern = "stackup-worker.towns.com", custom_domain = true }]
vars = { ENVIRONMENT = "omega", SKIP_TOWNID_VERIFICATION = "false" }
# created with
# wrangler kv:namespace create "CREATE_TOWN"
kv_namespaces = [
  { binding = "CREATE_TOWN", id = "c46483f3f6244f3dbb766efb742a77a9" },
  { binding = "OVERRIDES", id = "0608c8a945be4e30bbfbeb9b23c8c7bf" },
  { binding = "JOIN_TOWN", id = "9fb22ac1c083491e8a2f392dbbd3d603" },
  { binding = "LINK_WALLET_TO_ROOT_KEY", id = "75453c5564a84857b1d3b35b6fe32b4e" },
  { binding = "EMAIL_WHITELIST", id = "21cdaa431ba847488c812e764bc001de" },
  { binding = "TOWN_WHITELIST", id = "9c38e3c079ab49ebb1ca0f6ebaa6211b" },
]

[env.alpha]
routes = [{ pattern = "stackup-worker-alpha.towns.com", custom_domain = true }]
vars = { ENVIRONMENT = "alpha", SKIP_TOWNID_VERIFICATION = "false" }
# created with
# wrangler kv:namespace create "CREATE_TOWN" --env alpha
kv_namespaces = [
  { binding = "CREATE_TOWN", id = "cc442957ec224be6b79bbca07ac5e5ba" },
  { binding = "OVERRIDES", id = "071275d4239e4875863b2be676deaa8d" },
  { binding = "JOIN_TOWN", id = "7fad6a0c956e4f55b53006c096f3af84" },
  { binding = "LINK_WALLET_TO_ROOT_KEY", id = "dc5100388c994ad0ba15b8aaf74b8665" },
  { binding = "EMAIL_WHITELIST", id = "2c8323695f35412a8085d3578742ab7f" },
  { binding = "TOWN_WHITELIST", id = "4cc893654ea646f6b70cd195d80a77de" },
]
