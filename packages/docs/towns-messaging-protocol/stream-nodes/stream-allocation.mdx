---
title: "Stream Allocation"
---

# Stream Allocation on Towns Protocol

Stream Allocation is a fundamental component of the Towns Protocol that manages streams efficiently and reliably. This doc explains the key principles and processes governing stream allocation in the Towns ecosystem.

## **Principles of Stream Allocation**

1. **Base Mainnet and Towns Chain Authority**
   - **Base Mainnet Authority**: Base Mainnet controls channels and spaces.
   - **Towns Chain Authority**: The Stream Registry on Towns Chain manages all other stream allocations.
2. **User Stream Creation and Verification**
   - **User Stream Inception**: Each user stream starts with a verifiable user signature, linking it securely to its creator.
   - **Channel Stream Inception**: Clients initiate channel streams, which are then verified against existing channels in the Space contract on Base.
   - **Signature Requirement**: Creating a direct message (DM) stream requires the user's verifiable signature.
3. **Stream Allocation Process**
   - **Deterministic Allocation**: Streams are allocated based on three factors: Towns Chain block number, randomness, and active node list.
   - **Replication Standard**: The protocol maintains five replicas of each stream for redundancy and reliability.
4. **Workload Equality Among Nodes**
   - **Equal Work Distribution**: Each node handles a similar workload over time, regardless of which streams they manage.
   - **Adaptive Workload**: Stream allocation adjusts automatically to maintain equal work across nodes.
5. **Stream Rebalancing**
   - **Rebalancing on Node Joining/Leaving**: The system redistributes streams when network composition changes.
   - **Adding New Nodes**: New nodes receive stream replicas to integrate them as equal participants.
   - **Handling Node Departure**: When nodes leave, their streams are redistributed to maintain system balance.

## **Implementation Guidelines**

- **Ensuring Fair Distribution**: Monitor and adjust stream distribution to maintain node fairness and efficiency.
- **Secure Signature Verification**: Use robust verification methods for user signatures, particularly for DM streams.
- **Dynamic Rebalancing Logic**: Implement responsive rebalancing systems that adapt to network changes.