# CLAUDE.md - Stress Test Package

This file provides guidance for working with the stress test package.

## Wallet Management

### Transferring Funds Between Seed Phrases

When updating the seed phrase used for stress testing (e.g., in AWS Secrets Manager), you need to transfer ETH funds from wallets generated by the old seed to wallets generated by the new seed.

#### Process

1. **Generate a new seed phrase** (if needed):
   ```bash
   # Use any tool to generate a BIP39 mnemonic, or use the wallet generation tool
   yarn generate-wallets --seed "test test test test test test test test test test test junk" --start 0 --end 1
   ```

2. **Check current balances** of wallets from the old seed:
   ```bash
   yarn transfer-funds check --old-seed "your old seed phrase" --start 0 --end 40
   ```

3. **Transfer funds** from old to new wallets:
   ```bash
   yarn transfer-funds transfer \
     --old-seed "old seed phrase" \
     --new-seed "new seed phrase" \
     --start 0 \
     --end 40 \
     --rpc-url https://sepolia.base.org
   ```

4. **Update the seed phrase** in your environment:
   - For AWS environments: Update the secret in AWS Secrets Manager
   - For local testing: Update the MNEMONIC environment variable

5. **Verify the transfer** by checking balances of the new wallets:
   ```bash
   yarn transfer-funds check --old-seed "new seed phrase" --start 0 --end 40
   ```

#### Important Notes

- The stress tests use 40 wallets by default (indices 0-39)
- Always check balances before transferring to ensure you're not missing any funded wallets
- The transfer tool includes a 10% gas buffer by default to prevent failed transactions
- A 5-second safety delay is built in before transfers begin
- Each wallet's funds are transferred independently, so partial failures won't affect other transfers

#### Command Options

- `--old-seed`: Source seed phrase (required)
- `--new-seed`: Destination seed phrase (required for transfer)
- `--rpc-url`: Custom RPC URL (defaults to https://sepolia.base.org)
- `--start`: Starting wallet index (defaults to 0)
- `--end`: Ending wallet index (defaults to 40)
- `--gas-buffer`: Gas buffer percentage (defaults to 10)

#### Example: Full Migration

```bash
# 1. Check old wallet balances
yarn transfer-funds check --old-seed "your old twelve word mnemonic seed phrase goes here"

# 2. Transfer to new wallets
yarn transfer-funds transfer \
  --old-seed "your old twelve word mnemonic seed phrase goes here" \
  --new-seed "your new twelve word mnemonic seed phrase goes here"

# 3. Verify new wallet balances
yarn transfer-funds check --old-seed "your new twelve word mnemonic seed phrase goes here"
```